<!DOCTYPE html>
<html lang="az">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BEAcademy | BOSS Control Panel</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700;800&display=swap" rel="stylesheet">
    <style>
        /* S…ônin orijinal still…ôrin */
        .admin-main { max-width: 1200px; margin: 40px auto; padding: 20px; }
        .stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-bottom: 40px; }
        .stat-card { background: #000; color: #fff; padding: 20px; border-left: 5px solid #e60000; box-shadow: 5px 5px 15px rgba(0, 0, 0, 0.1); }
        .staff-list { background: #fff; border: 3px solid #000; padding: 30px; margin-top: 30px; box-shadow: 10px 10px 0px #e60000; }
        .search-container { position: relative; width: 300px; }
        .search-container input { width: 100%; padding: 10px 15px; border: 2px solid #000; font-weight: 600; outline: none; transition: 0.3s; }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        th { background: #000; color: #fff; text-align: left; padding: 15px; text-transform: uppercase; font-size: 13px; }
        td { padding: 15px; border-bottom: 1px solid #eee; font-size: 14px; color: #333; }
        .action-btn { background: #000; color: #fff; border: none; padding: 8px 12px; cursor: pointer; font-size: 10px; font-weight: 700; border-radius: 4px; }
        .action-btn:hover { background: #e60000; }
        .management-box h3 { margin-bottom: 20px; border-bottom: 3px solid #e60000; display: inline-block; padding-bottom: 5px; font-weight: 800; }
        .input-box { margin-bottom: 15px; display: flex; align-items: center; border: 1px solid #ddd; padding: 5px 10px; border-radius: 5px; }
        .input-box input { border: none; outline: none; width: 100%; padding: 8px; }
        .login-btn { width: 100%; padding: 12px; background: #000; color: white; border: none; font-weight: 700; cursor: pointer; }
    </style>
</head>

<body style="background: #f9f9f9; display: block; font-family: 'Poppins', sans-serif;">

    <div class="admin-main">
        <header style="display: flex; justify-content: space-between; align-items: center; border-bottom: 4px solid #000; padding-bottom: 20px; margin-bottom: 40px;">
            <div class="logo" style="margin:0; font-size: 24px; font-weight: 800;">
                <span style="color: #e60000;">BE</span>Academy
            </div>
            <div style="text-align: right;">
                <div style="font-weight: 900; letter-spacing: 1px; font-size: 18px;">
                    Sƒ∞STEM ADMƒ∞Nƒ∞: <span style="color:#e60000;">BOSS</span>
                </div>
                <a href="index.html" style="color:#000; font-size: 12px; font-weight: 700; text-decoration: underline;">Sƒ∞STEMD∆èN √áIXI≈û</a>
            </div>
        </header>

        <div class="stats-grid">
            <div class="stat-card">
                <small>C…ômi ∆èm…ôkda≈ü</small>
                <h2 id="totalStaff">0</h2>
            </div>
        </div>

        <div style="display: grid; grid-template-columns: 1fr 2fr; gap: 40px; align-items: start;">
            <div class="management-box" style="background: #fff; border: 3px solid #000; padding: 30px; box-shadow: 10px 10px 0px #000;">
                <h3>YENƒ∞ ∆èM∆èKDA≈û</h3>
                <form id="addStaffForm">
                    <div class="input-box"><span>üë§</span><input type="text" id="newFullName" placeholder="Ad Soyad" required></div>
                    <div class="input-box"><span>üîë</span><input type="text" id="newUsername" placeholder="ƒ∞stifad…ô√ßi adƒ±" required></div>
                    <div class="input-box"><span>‚úâÔ∏è</span><input type="email" id="newEmail" placeholder="Gmail √ºnvanƒ±" required></div>
                    <div class="input-box"><span>üîí</span><input type="password" id="newPass" placeholder="Parol" required></div>
                    <button type="submit" class="login-btn">BAZAYA ∆èLAV∆è ET</button>
                </form>
            </div>

            <div class="staff-list">
                <h3>∆èM∆èKDA≈ûLARIN Sƒ∞YAHISI</h3>
                <table>
                    <thead>
                        <tr>
                            <th>Ad Soyad</th>
                            <th>Login</th>
                            <th>Email</th>
                            <th>Sil</th>
                        </tr>
                    </thead>
                    <tbody id="staffTableBody"></tbody>
                </table>
            </div>
        </div>
    </div>

    <script>
        const DB_URL = "https://beacademy-c8316-default-rtdb.firebaseio.com/users";

        // 1. Sƒ∞YAHINI BAZADAN Y√úKL∆èM∆èK
        async function loadStaff() {
            try {
                const res = await fetch(DB_URL + ".json");
                const data = await res.json();
                const tableBody = document.getElementById("staffTableBody");
                tableBody.innerHTML = "";
                
                if (data) {
                    const users = Object.keys(data);
                    document.getElementById("totalStaff").innerText = users.length;
                    
                    users.forEach(key => {
                        const u = data[key];
                        tableBody.innerHTML += `
                            <tr>
                                <td>${u.fullname}</td>
                                <td><strong>${u.username}</strong></td>
                                <td>${u.email || '---'}</td>
                                <td><button class="action-btn" onclick="deleteUser('${key}')">Sƒ∞L</button></td>
                            </tr>
                        `;
                    });
                } else {
                    document.getElementById("totalStaff").innerText = "0";
                }
            } catch (err) { console.log("Y√ºkl…ôm…ô x…ôtasƒ±:", err); }
        }

        // 2. YENƒ∞ ƒ∞≈û√áƒ∞ ∆èLAV∆è ETM∆èK (Fƒ∞REBASE-∆è)
        document.getElementById("addStaffForm").addEventListener("submit", async (e) => {
            e.preventDefault();
            
            const username = document.getElementById("newUsername").value.trim();
            const userData = {
                fullname: document.getElementById("newFullName").value.trim(),
                username: username,
                email: document.getElementById("newEmail").value.trim(),
                password: document.getElementById("newPass").value.trim()
            };

            try {
                const res = await fetch(`${DB_URL}/${username}.json`, {
                    method: 'PUT',
                    body: JSON.stringify(userData)
                });

                if (res.ok) {
                    alert("∆èm…ôkda≈ü bazaya uƒüurla d√º≈üd√º! ‚úÖ");
                    document.getElementById("addStaffForm").reset();
                    loadStaff();
                }
            } catch (err) { alert("X…ôta ba≈ü verdi!"); }
        });

        // 3. ƒ∞≈û√áƒ∞Nƒ∞ Sƒ∞LM∆èK
        async function deleteUser(username) {
            if(confirm(username + " silinsin?")) {
                await fetch(`${DB_URL}/${username}.json`, { method: 'DELETE' });
                loadStaff();
            }
        }

        // S…ôhif…ô a√ßƒ±landa siyahƒ±nƒ± g√∂st…ôr
        window.onload = loadStaff;
    </script>
</body>
</html>
